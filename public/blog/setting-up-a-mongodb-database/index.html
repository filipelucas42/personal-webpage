<html>
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <link rel="stylesheet" href="/new.css">
     <script async src="https://www.googletagmanager.com/gtag/js?id=UA-161652863-2"></script>
     <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-161652863-2');
     </script>
	 <title>Setting Up a MongoDB database</title>
</head>
<body>
     <head>
    <nav>
        <a href="/">Home</a>
        /
        <a href="/blog">Blog</a>
        /
         <a href="/about">About</a>
    </nav>
</head>
		 <h1 id="setting-up-a-mongodb-database">Setting up a MongoDB database</h1>
<p>In this article I will explain how to set up a MongoDB database. This article will be split in two main steps:</p>
<ul>
<li>Install MongoDB</li>
<li>Run MongoDB and set up authentication</li>
<li>Make a simple NodeJS connection</li>
</ul>
<h2 id="install-mongodb">Install MongoDB</h2>
<p>Most of the repositories have MongoDB however I do not recommend install it this way because usually the repositories do not have the most recent stable version.</p>
<p>Instead of installing with the repository you should download it from the <a href="https://www.mongodb.com/download-center/community">MongoDB website</a>. There you can select the version, OS and package, in package you should choose the <code>TGZ</code> option.</p>
<p>After download the tar file extract it with:</p>
<pre><code>tar xf &lt;file&gt;
</code></pre><p>After extract go inside it and copy all the binaries that are in the folder <code>bin</code> to a folder of your choice. If you are the only user I would recommend to copy these file to: <code>~/.local/bin/mongodb</code></p>
<p>After copy the files you should add the path to your PATH variable, you can do this by copying the following line to <code>/etc/environment</code> or <code>~/.bashrc</code>:</p>
<pre><code>export PATH=$PATH:~/.local/bin/mongodb
</code></pre><h2 id="run-mongodb-and-set-up-authentication">Run MongoDB and set up authentication</h2>
<p>To run MongoDB open a terminal and type:</p>
<pre><code>mongod --dbpath &lt;path_to_database&gt;
</code></pre><p>The &lt;path_to_database&gt; can be any path of your choice, all the files of database will be stored in this path. Note that the path/folders need to be created before running the command. Example:</p>
<pre><code>mongod --dbpath ~/mongodb
</code></pre><p>After start MongoDB is time to create authentication credentials, to enter the database open a new terminal and type the command:</p>
<pre><code>mongo
</code></pre><p>This command will open a console to interact with the database. Note that for localhost connections you do not need authentication.</p>
<p>To set up authentication credentials you need to create a database to store them. To create a database simply type in the console <code>use admin</code>, this will create a database inside MongoDB called <em>admin</em>.</p>
<p>In the console to create the credentials type the command:</p>
<pre><code>db.createUser({user:&quot;username&quot;, pwd:passwordPrompt(), roles:[&quot;userAdminAnyDatabase&quot;]})
</code></pre><p>This create a user for the database called <em>username</em>, the <code>passwordPrompt()</code> will ask for a password, the database stores the hash and not the password itself.</p>
<h2 id="make-a-simple-nodejs-connection">Make a simple NodeJS connection</h2>
<p>First install the MogoDB drivers with npm, then follow the next code example to make a connection:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">MongoClient</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;mongodb&#39;</span>).<span style="color:#a6e22e">MongoClient</span>;
<span style="color:#a6e22e">MongoClient</span>.<span style="color:#a6e22e">connect</span>(<span style="color:#e6db74">&#34;mongodb://username:passwordn@localhost:27017/v2?authMechanism=DEFAULT&amp;authSource=admin&#34;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">db</span>) {
  <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">err</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">dir</span>(<span style="color:#a6e22e">err</span>); }

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">collection</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">collection</span>(<span style="color:#e6db74">&#39;test&#39;</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">doc1</span> <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;hello&#39;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;doc1&#39;</span>};

  <span style="color:#a6e22e">collection</span>.<span style="color:#a6e22e">insert</span>(<span style="color:#a6e22e">doc1</span>);

});
</code></pre></div><p>Substitute username and password with the ones used to create the MongoDB user in the process of create the authentication credentials.</p>

     
</body>
</html>
